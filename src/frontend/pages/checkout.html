<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - EcoFinds</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style> 
        body { font-family: 'Inter', sans-serif; } 
        /* Custom styles for the stepper and active radio button */
        .stepper-item.active .stepper-circle {
            background-color: #16A34A; /* green-600 */
            color: white;
        }
        .stepper-item.active .stepper-label {
            color: #16A34A; /* green-600 */
            font-weight: 600;
        }
        input[type="radio"]:checked + label {
            border-color: #16A34A; /* green-600 */
            background-color: #D1FAE5; /* green-100 */
        }
    </style>
</head>
<body class="bg-gray-50">
    <div data-navbar></div>
    <main class="container mx-auto px-4 py-8">
        <!-- Stepper -->
        <div class="max-w-2xl mx-auto mb-8">
            <ol class="flex items-center w-full text-sm font-medium text-center text-gray-500">
                <li class="stepper-item flex md:w-full items-center text-green-600 sm:after:content-[''] after:w-full after:h-1 after:border-b after:border-green-600 after:border-1 after:hidden sm:after:inline-block after:mx-6 xl:after:mx-10">
                    <span class="flex items-center sm:after:hidden after:mx-2">
                        <svg class="w-4 h-4 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/></svg>
                        Cart
                    </span>
                </li>
                <li class="stepper-item flex md:w-full items-center text-green-600 sm:after:content-[''] after:w-full after:h-1 after:border-b after:border-green-600 after:border-1 after:hidden sm:after:inline-block after:mx-6 xl:after:mx-10">
                    <span class="flex items-center sm:after:hidden after:mx-2">
                       <svg class="w-4 h-4 mr-2.5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"/></svg>
                        Review
                    </span>
                </li>
                <li class="stepper-item active flex items-center">
                    <span class="stepper-circle mr-2 w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center">3</span>
                    <span class="stepper-label">Checkout</span>
                </li>
            </ol>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
            <!-- Shipping & Payment Form -->
            <form id="checkoutForm" class="lg:col-span-2 bg-white p-8 rounded-xl shadow-lg space-y-6">
                <div>
                    <h2 class="text-2xl font-bold mb-4">Shipping Information</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div class="sm:col-span-2">
                            <label for="fullName" class="block text-sm font-medium text-gray-700">Full Name *</label>
                            <input type="text" id="fullName" required class="mt-1 w-full p-2 border rounded-lg">
                        </div>
                        <div class="sm:col-span-2">
                            <label for="address" class="block text-sm font-medium text-gray-700">Street Address *</label>
                            <input type="text" id="address" required class="mt-1 w-full p-2 border rounded-lg">
                        </div>
                        <div>
                            <label for="city" class="block text-sm font-medium text-gray-700">City *</label>
                            <input type="text" id="city" required class="mt-1 w-full p-2 border rounded-lg">
                        </div>
                         <div>
                            <label for="state" class="block text-sm font-medium text-gray-700">State *</label>
                            <input type="text" id="state" required class="mt-1 w-full p-2 border rounded-lg">
                        </div>
                        <div>
                            <label for="postalCode" class="block text-sm font-medium text-gray-700">ZIP Code *</label>
                            <input type="text" id="postalCode" required class="mt-1 w-full p-2 border rounded-lg">
                        </div>
                        <div>
                            <label for="country" class="block text-sm font-medium text-gray-700">Country *</label>
                            <select id="country" required class="mt-1 w-full p-2 border rounded-lg bg-white"><option>United States</option><option>Canada</option><option>India</option></select>
                        </div>
                    </div>
                </div>
                 <div class="border-t pt-6">
                    <h2 class="text-2xl font-bold mb-4">Payment Details</h2>
                     <p class="text-gray-500 text-sm mb-4">This is a demo. Please do not enter real card details.</p>
                    <div>
                        <label for="cardNumber" class="block text-sm font-medium text-gray-700">Card Number</label>
                        <input type="text" id="cardNumber" placeholder="xxxx xxxx xxxx xxxx" required class="mt-1 w-full p-2 border rounded-lg">
                    </div>
                 </div>
            </form>

            <!-- Order Summary -->
            <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg space-y-4 sticky top-28">
                <h2 class="text-2xl font-bold text-center">Review your cart</h2>
                <div id="orderItems" class="space-y-4 max-h-64 overflow-y-auto pr-2">
                    <!-- Order items loaded here -->
                </div>
                <div class="border-t pt-4">
                    <label for="discount" class="text-sm font-medium">Discount code</label>
                    <div class="flex space-x-2 mt-1">
                        <input type="text" id="discount" class="w-full p-2 border rounded-lg" placeholder="ECOFRIENDLY">
                        <button class="bg-gray-200 text-gray-700 font-semibold px-4 rounded-lg hover:bg-gray-300">Apply</button>
                    </div>
                </div>
                <div id="orderTotal" class="border-t pt-4 mt-4 space-y-2">
                    <!-- Order total loaded here -->
                </div>
                <button type="submit" form="checkoutForm" class="w-full mt-4 py-3 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition shadow-md">
                    Pay Now
                </button>
                <p class="text-xs text-gray-500 text-center flex items-center justify-center gap-2 mt-2">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 1.944A11.954 11.954 0 012.166 5.068l.255.402a11.933 11.933 0 0115.158 0l.255-.402A11.954 11.954 0 0110 1.944zM10 18c-3.132 0-5.9-1.67-7.447-4.243l.255-.402a11.933 11.933 0 0114.384 0l.255.402C15.9 16.33 13.132 18 10 18z" clip-rule="evenodd" /><path d="M10 4.5a.75.75 0 01.75.75v5.5a.75.75 0 01-1.5 0v-5.5A.75.75 0 0110 4.5z" /></svg>
                    Secure Checkout - SSL Encrypted
                </p>
            </div>
        </div>
    </main>
    <script src="../js/auth.js"></script>
    <script src="../js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', renderCheckout);

        function renderCheckout() {
            const cart = JSON.parse(localStorage.getItem('ecofinds-cart')) || [];
            const itemsContainer = document.getElementById('orderItems');
            const totalContainer = document.getElementById('orderTotal');

            if (cart.length === 0) {
                window.location.href = './cart.html';
                return;
            }

            let subtotal = 0;
            itemsContainer.innerHTML = cart.map(item => {
                subtotal += Number(item.price);
                return `
                    <div class="flex items-center space-x-4 text-sm border-b pb-2">
                        <img src="${item.image_url}" class="w-16 h-16 object-cover rounded-lg">
                        <div class="flex-grow">
                            <p class="font-semibold">${item.title}</p>
                            <p class="text-xs text-gray-500">Qty: 1</p>
                        </div>
                        <p class="font-semibold">$${Number(item.price).toFixed(2)}</p>
                    </div>
                `;
            }).join('');
            
            const shipping = 5.00;
            const total = subtotal + shipping;

            totalContainer.innerHTML = `
                <div class="flex justify-between"><span>Subtotal</span><span>$${subtotal.toFixed(2)}</span></div>
                <div class="flex justify-between"><span>Shipping</span><span>$${shipping.toFixed(2)}</span></div>
                <div class="flex justify-between font-bold text-lg border-t pt-2 mt-2"><span>Total</span><span>$${total.toFixed(2)}</span></div>
            `;
        }

        document.getElementById('checkoutForm').addEventListener('submit', (e) => {
            e.preventDefault();
            alert('Thank you for your order! This is a demo, so no payment has been processed.');
            localStorage.removeItem('ecofinds-cart');
            window.location.href = './index.html';
        });
    </script>
</body>
</html>

